function ConvertDateFromDiv(a){var b=a.toString().split(" "),c=b[0].split("/"),d=c[2]+"/"+c[1]+"/"+c[0]+" "+b[1],e=new Date(d);return"Invalid Date"==e&&(e=new Date(a)),e.toLocaleDateString()}function getIcon(a){return a?'<i class="fa fa-check text-success fa-fw"></i>':'<i class="fa fa-times text-danger fa-fw"></i>'}function getStatusIcon(a){return"check"===a?'<i class="fa fa-exclamation text-warning fa-fw"></i>':"fail"===a?'<i class="fa fa-exclamation-triangle text-warning fa-fw"></i>':"error"===a?'<i class="fa fa-times text-danger fa-fw"></i>':"pass"===a?'<i class="fa fa-check text-success fa-fw"></i>':"error"}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(a,b){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function parseTeachers(a){var b=[];return Object.entries(a).forEach(function(a){var c=_slicedToArray(a,2),d=c[0],e=c[1];"teachers"===d&&Object.entries(e).forEach(function(a){var c=_slicedToArray(a,2),d=(c[0],c[1]);b+=d.firstname+" "+d.lastname+"<br>"})}),b}define(["core/config","core/ajax","jquery","block_filescan/jquery.dataTables","block_filescan/buttons.html5","block_filescan/dataTables.buttons","block_filescan/dataTables.select"],function(a,b,c,d){return{init:function(){c(document).ready(function(){c.noConflict(!0),c("#view").DataTable({processing:!0,serverSide:!0,ajax:function(a,c,d){b.call([{methodname:"block_filescan_request_files",args:a,done:function(a){c(a)},fail:function(){console.error("Could not get data!")}}])},select:!0,dom:"Bfrtip",buttons:["copy","csv"],columnDefs:[{targets:"id",visible:!1}],columns:[{data:"status",className:"text-center",render:function(a){return getStatusIcon(a)}},{data:"hastext",className:"text-center",render:function(a){return getIcon(a)}},{data:"hastitle",className:"text-center",render:function(a){return getIcon(a)}},{data:"hasoutline",className:"text-center",render:function(a){return getIcon(a)}},{data:"haslanguage",className:"text-center",render:function(a){return getIcon(a)}},{data:"timechecked",className:"text-center",render:function(a){return ConvertDateFromDiv(Date.parse(a))}},{data:"courseinfo",render:function(b,c,d,e){var f="/course/view.php?id=";if(b){var g=JSON.parse(b),h=[];return g.forEach(function(b){var c,d;b.courseid&&b.student_enrollment?(c=f+b.courseid,d=b.student_enrollment):(c="Course URL Undefined",d=0);var e=parseTeachers(b);b?h.push('<div><a href="'+c+'>"'+b.shortname+"</a> "+d+"</div><div>"+e+'</div><div class="mb-1"><a href="'+a.wwwroot+"/mod/resource/view.php?id="+b.instance_id+">"+b.filename+"</a></div>"):h.push("No course information found. This may be an invalid courseinfo entry within the block_filescan_files table.")}),h.join("<br>")}return"No response returned from the DataTables service. Are you sure the course exists?<br><strong>Ref id: "+d.id+"</strong>"}}]})})}}});